{"version":3,"file":null,"sources":["/Volumes/Users/clmsis/Websites/__/spritz.js/node_modules/knot.js/src/knot.js","/Volumes/Users/clmsis/Websites/__/spritz.js/node_modules/wait.js/dist/wait.module.js","/Volumes/Users/clmsis/Websites/__/spritz.js/src/spritz.js"],"sourcesContent":["export default (object = {}) => {\n  const events = {}\n\n  function on(name, handler) {\n    events[name] = events[name] || []\n    events[name].push(handler)\n    return this\n  }\n\n  function once(name, handler) {\n    handler._once = true\n    on(name, handler)\n    return this\n  }\n\n  function off(name, handler = false) {\n    handler\n      ? events[name].splice(events[name].indexOf(handler), 1)\n      : delete events[name]\n\n    return this\n  }\n\n  function emit(name, ...args) {\n    // cache the events, to avoid consequences of mutation\n    const cache = events[name] && events[name].slice()\n\n    // only fire handlers if they exist\n    cache && cache.forEach(handler => {\n      // remove handlers added with 'once'\n      handler._once && off(name, handler)\n\n      // set 'this' context, pass args to handlers\n      handler.apply(this, args)\n    })\n\n    return this\n  }\n\n  return {\n    ...object,\n\n    on,\n    once,\n    off,\n    emit\n  }\n}\n","/*!\n* wait.js 1.0.0 - Javascript library to easily delay and chain functions.\n* Copyright (c) 2017 maoosi <hello@sylvainsimao.fr> - https://github.com/maoosi/wait.js\n* License: MIT\n*/\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\nvar Wait = function () {\n    function Wait() {\n        classCallCheck(this, Wait);\n\n        // initiate wait vars\n        this.waitQueue = [];\n        this.waitTimer = false;\n        this.waitExecution = false;\n    }\n\n    createClass(Wait, [{\n        key: 'handle',\n        value: function handle(func) {\n            var milliseconds = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n            // handle wait\n            this.waitQueue.push({\n                'func': func,\n                'timeout': milliseconds\n            });\n\n            if (!this.waitExecution) {\n                this.next();\n            }\n        }\n    }, {\n        key: 'next',\n        value: function next() {\n            var _this = this;\n\n            // execute next\n            if (this.waitQueue.length > 0) {\n                var c = this.waitQueue.shift();\n                var f = c['func'];\n                var t = c['timeout'];\n\n                if (t !== false) {\n                    f();\n                    this.waitExecution = true;\n                    this.waitTimer = setTimeout(function () {\n                        _this.next();\n                    }, t);\n                } else {\n                    f();\n                    this.waitExecution = false;\n                    this.next();\n                }\n            }\n        }\n    }]);\n    return Wait;\n}();\n\nexport default Wait;\n","import knot from 'knot.js'\nimport Wait from 'wait.js'\n\nexport default class Spritz {\n\n    /**\n        --- CORE ---\n    **/\n\n    constructor (selector, options = {}) {\n    // instance constructor\n        this.options = {\n            picture: options.picture || [],\n            steps: options.steps || 1,\n            rows: options.rows || 1\n        }\n\n        this.selector = typeof selector === 'string'\n            ? document.querySelector(selector)\n            : selector\n\n        this.emitter = knot()\n        this.waitter = new Wait()\n        this.supportsWebP = this._supportsWebP()\n\n        this.initiated = false\n\n        return this\n    }\n\n    _globalVars () {\n    // global vars\n        this.canvas = false\n        this.ctx = false\n        this.loaded = false\n        this._resetUntil()\n        this.anim = false\n        this.columns = Math.ceil(this.options.steps / this.options.rows)\n        this.currentFps = 15\n        this.flipped = false\n    }\n\n    _throttle (callback, delay) {\n    // throttle function\n        let last\n        let timer\n\n        return () => {\n            let context = this\n            let now = +new Date()\n            let args = arguments\n\n            if (last && now < last + delay) {\n                clearTimeout(timer)\n                timer = setTimeout(() => {\n                    last = now\n                    callback.apply(context, args)\n                }, delay)\n            } else {\n                last = now\n                callback.apply(context, args)\n            }\n        }\n    }\n\n    _bindEvents () {\n    // create events listeners\n        this.resize = this._throttle((event) => {\n            this._resize()\n        }, 250)\n\n        window.addEventListener('resize', this.resize, false)\n    }\n\n    _unbindEvents () {\n    // remove events listeners\n        window.removeEventListener('resize', this.resize, false)\n    }\n\n    _resize () {\n    // viewport resize triggered\n        this._loadPicture()\n        this.emitter.emit('resize', this.pic)\n    }\n\n    /**\n        --- API ---\n    **/\n\n    init (step = 1) {\n    // init the sprite\n        if (!this.initiated) {\n            this.initialStep = step\n            this.currentStep = step\n\n            this._globalVars()\n            this._bindEvents()\n            this._createCanvas()\n            this._loadPicture()\n\n            this.initiated = true\n            this.emitter.emit('ready')\n        }\n\n        return this\n    }\n\n    destroy () {\n    // destroy sprite instance\n        this.waitter.handle(() => {\n            if (this.initiated) {\n                // stop stuff\n                this.stop()\n                this._unbindEvents()\n\n                // reset & remove canvas\n                this.canvas.parentNode.removeChild(this.canvas)\n                this.container.parentNode.removeChild(this.container)\n                this.canvas = false\n                this.ctx = false\n\n                // turn initiated to false\n                this.initiated = false\n\n                // emitt destroy\n                this.emitter.emit('destroy')\n\n                // turn off emitters\n                this.emitter.off('ready')\n                this.emitter.off('destroy')\n                this.emitter.off('resize')\n                this.emitter.off('play')\n                this.emitter.off('load')\n                this.emitter.off('change')\n                this.emitter.off('wait')\n                this.emitter.off('flip')\n                this.emitter.off('pause')\n                this.emitter.off('stop')\n            }\n        })\n\n        return this\n    }\n\n    play (direction = false) {\n    // play animation forward\n        this.waitter.handle(() => {\n            this.animDirection = (direction === 'backward') ? 'backward' : 'forward'\n            this._startAnimation()\n\n            this.emitter.emit('play', this.animDirection)\n        })\n\n        return this\n    }\n\n    playback () {\n    // play animation backward\n        this.waitter.handle(() => {\n            this.animDirection = 'backward'\n            this._startAnimation()\n\n            this.emitter.emit('play', this.animDirection)\n        })\n\n        return this\n    }\n\n    pause (silent = false) {\n    // pause animation\n        this.waitter.handle(() => {\n            this._pauseAnimation()\n\n            if (!silent) {\n                this.emitter.emit('pause')\n            }\n        })\n\n        return this\n    }\n\n    stop () {\n    // stop animation (= pause + reset)\n        this.waitter.handle(() => {\n            this.pause(true)\n            this.step(this.initialStep)\n\n            this.emitter.emit('stop')\n        })\n\n        return this\n    }\n\n    wait (milliseconds = 0) {\n    // chainable timeout\n        this.waitter.handle(() => {\n            this.emitter.emit('wait', milliseconds)\n        }, milliseconds)\n\n        return this\n    }\n\n    step (step = 1) {\n    // change the current frame/step\n        this.waitter.handle(() => {\n            let fromStep = this.currentStep\n            this.currentStep = step\n            this._draw()\n\n            this.emitter.emit('change', fromStep, this.currentStep)\n        })\n\n        return this\n    }\n\n    fps (speed) {\n    // change animation speed\n        this.waitter.handle(() => {\n            this.currentFps = speed\n        })\n\n        return this\n    }\n\n    until (step, loop = 1) {\n    // next animation will stop at this\n        this.waitter.handle(() => {\n            this.stopAtStep = step\n            this.stopAtLoop = loop\n        })\n\n        return this\n    }\n\n    next () {\n    // go to the next frame\n        this.waitter.handle(() => {\n            this.animDirection = 'forward'\n            let fromStep = this.currentStep\n            this.currentStep = this._targetStep()\n            this._draw()\n\n            this.emitter.emit('change', fromStep, this.currentStep)\n        })\n\n        return this\n    }\n\n    prev () {\n    // go to the previous frame\n        this.waitter.handle(() => {\n            this.animDirection = 'backward'\n            let fromStep = this.currentStep\n            this.currentStep = this._targetStep()\n            this._draw()\n\n            this.emitter.emit('change', fromStep, this.currentStep)\n        })\n\n        return this\n    }\n\n    get (data, callback = false) {\n    // return data, then call the callback function with result\n        this.waitter.handle(() => {\n            switch (data) {\n                case 'step':\n                    return callback !== false ? callback.call(this, this.currentStep) : this.currentStep\n                case 'picture':\n                    return callback !== false ? callback.call(this, this.pic) : this.pic\n                default:\n                    return false\n            }\n        })\n\n        return this\n    }\n\n    flip () {\n    // flip the sprite horizontally\n        this.waitter.handle(() => {\n            let css = this.flipped\n                ? 'width:100%;height:100%;'\n                : 'width:100%;height:100%;-webkit-transform:scale(-1, 1);-ms-transform:scale(-1, 1);transform:scale(-1, 1);-webkit-filter:FlipH;filter:FlipH;'\n\n            this.container.setAttribute('style', css)\n            this.flipped = !this.flipped\n            this.emitter.emit('flip')\n        })\n\n        return this\n    }\n\n    on (...args) { return this.emitter.on(...args) }\n    off (...args) { return this.emitter.off(...args) }\n\n    /**\n        --- ANIMATE ---\n    **/\n\n    _resetUntil () {\n    // reset the \"until()\" api command\n        this.stopAtLoop = false\n        this.stopAtStep = false\n    }\n\n    _targetStep () {\n    // return the following step to be displayed\n        if (this.animDirection === 'forward') {\n            return this.currentStep < this.options.steps\n                ? this.currentStep + 1\n                : 1\n        } else {\n            return this.currentStep > 1\n                ? this.currentStep - 1\n                : this.options.steps\n        }\n    }\n\n    _animate (timestamp) {\n    // frame animation\n        if (this.initiated) {\n            if (this.animTime === undefined) {\n                this.animTime = timestamp\n            }\n\n            let seg = Math.floor((timestamp - this.animTime) / (1000 / this.currentFps))\n            let pauseAnim = false\n\n            if (seg > this.animFrame) {\n                this.animFrame = seg\n                let fromStep = this.currentStep\n                this.currentStep = this._targetStep()\n\n                let draw = true\n                if (this.currentStep === this.stopAtStep) {\n                    this.currentLoop ++\n                    if (this.currentLoop === this.stopAtLoop) {\n                        draw = false\n                    }\n                }\n\n                if (draw) {\n                    this._draw()\n                    this.emitter.emit('change', fromStep, this.currentStep)\n                } else {\n                    this.pause()\n                    pauseAnim = true\n                }\n            }\n\n            if (!pauseAnim && !this.requireStop) {\n                this.anim = window.requestAnimationFrame((timestamp) => this._animate(timestamp))\n            }\n        }\n    }\n\n    _startAnimation () {\n    // start animation\n        if (!this.anim) {\n            this.requireStop = false\n            this.animTime = undefined\n            this.animFrame = -1\n            this.currentLoop = 0\n            this.anim = window.requestAnimationFrame((timestamp) => this._animate(timestamp))\n        }\n    }\n\n    _pauseAnimation () {\n    // pause animation\n        if (this.anim) {\n            this._resetUntil()\n            this.requireStop = true\n            window.cancelAnimationFrame(this.anim)\n            this.anim = false\n        }\n    }\n\n    /**\n        --- DETECT & CALCULATE ---\n    **/\n\n    _selectPicture () {\n    // select picture src from list\n        for (let i = 0; i < this.options.picture.length; i++) {\n            let pic = this.options.picture[i]\n            if (this._supportsFormat(pic.srcset) && this._matchesMedia(pic.media)) {\n                this.pic = pic\n                return pic.srcset\n            }\n        }\n        return false\n    }\n\n    _supportsFormat (filename) {\n    // return true if filename is a supported format\n        let ext = this._getExtension(filename)\n        return (ext === 'webp' && this.supportsWebP) || ext !== 'webp'\n    }\n\n    _supportsWebP () {\n    // return true if webP is supported\n        let canvas = document.createElement('canvas')\n        canvas.width = canvas.height = 1\n        return canvas.toDataURL && canvas.toDataURL('image/webp').indexOf('data:image/webp') === 0\n    }\n\n    _getExtension (filename) {\n    // return the filename extension\n        return (/[.]/.exec(filename)) ? /[^.]+$/.exec(filename)[0] : undefined\n    }\n\n    _matchesMedia (query = undefined) {\n    // return true if matches the media query\n        let mq = window.matchMedia(query)\n        return query !== undefined ? mq.matches : true\n    }\n\n    _setDimensions () {\n    // calculate sprite dimensions\n        this.stepWidth = this.pic.width / this.columns\n        this.stepHeight = this.pic.height / this.options.rows\n        this.stepRatio = this.stepWidth / this.stepHeight\n\n        this.parentWidth = this.selector.clientWidth\n        this.parentHeight = this.selector.clientHeight\n        this.parentRatio = this.parentWidth / this.parentHeight\n\n        if (this.pic.objectFit === 'cover') {\n            if (this.stepRatio >= this.parentRatio) {\n                this.canvasHeight = this.parentHeight\n                this.canvasWidth = (this.stepWidth * this.canvasHeight) / this.stepHeight\n            } else {\n                this.canvasWidth = this.parentWidth\n                this.canvasHeight = (this.stepHeight * this.canvasWidth) / this.stepWidth\n            }\n        } else {\n            if (this.stepRatio >= this.parentRatio) {\n                this.canvasWidth = this.parentWidth\n                this.canvasHeight = (this.stepHeight * this.canvasWidth) / this.stepWidth\n            } else {\n                this.canvasHeight = this.parentHeight\n                this.canvasWidth = (this.stepWidth * this.canvasHeight) / this.stepHeight\n            }\n        }\n\n        this.canvas.width = this.canvasWidth\n        this.canvas.height = this.canvasHeight\n    }\n\n    /**\n        --- CREATE & DRAW ---\n    **/\n\n    _loadPicture () {\n    // load source picture\n        this.picture = new Image()\n        this.picture.onload = () => {\n            if (!this.loaded) {\n                this.emitter.emit('load', this.pic)\n                this.loaded = true\n            }\n            this._draw()\n        }\n        this.picture.src = this._selectPicture()\n    }\n\n    _draw () {\n    // draw sprite\n        if (this.initiated) {\n            this._setDimensions()\n            this._drawPicture()\n        }\n    }\n\n    _drawPicture () {\n    // draw picture into canvas\n        let targetColumn = Math.floor((this.currentStep - 1) % this.columns)\n        let targetRow = Math.floor((this.currentStep - 1) / this.columns)\n\n        let posX = targetColumn * this.stepWidth\n        let posY = targetRow * this.stepHeight\n\n        this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n\n        this.ctx.drawImage(\n            this.picture,\n            Math.round(posX), Math.round(posY),\n            this.stepWidth,\n            this.stepHeight,\n            0, 0,\n            this.canvasWidth,\n            this.canvasHeight\n        )\n    }\n\n    _createCanvas () {\n    // create html5 canvas\n        this.canvas = document.createElement('canvas')\n        this.canvas.setAttribute('style', 'position:absolute;left:50%;top:50%;-webkit-transform:translateY(-50%) translateY(1px) translateX(-50%) translateX(1px);-ms-transform:translateY(-50%) translateY(1px) translateX(-50%) translateX(1px);transform:translateY(-50%) translateY(1px) translateX(-50%) translateX(1px);')\n\n        this.container = document.createElement('div')\n        this.container.setAttribute('style', 'width:100%;height:100%;position:relative;')\n        this.container.appendChild(this.canvas)\n\n        this.selector.appendChild(this.container)\n        this.ctx = this.canvas.getContext('2d')\n    }\n\n}\n"],"names":["object","events","on","name","handler","push","once","_once","off","splice","indexOf","emit","args","cache","slice","forEach","apply","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","prototype","get","property","receiver","Function","desc","Object","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","value","getter","call","set","setter","Wait","waitQueue","waitTimer","waitExecution","handle","func","milliseconds","arguments","next","_this","c","shift","f","t","setTimeout","Spritz","selector","options","picture","steps","rows","document","querySelector","emitter","knot","waitter","supportsWebP","_supportsWebP","initiated","canvas","ctx","loaded","_resetUntil","anim","columns","Math","ceil","currentFps","flipped","callback","delay","last","timer","context","now","Date","resize","_throttle","event","_resize","addEventListener","removeEventListener","_loadPicture","pic","step","initialStep","currentStep","_globalVars","_bindEvents","_createCanvas","stop","_unbindEvents","parentNode","removeChild","container","direction","animDirection","_startAnimation","silent","_pauseAnimation","pause","fromStep","_draw","speed","loop","stopAtStep","stopAtLoop","_targetStep","data","css","setAttribute","timestamp","animTime","seg","floor","pauseAnim","animFrame","draw","currentLoop","requireStop","window","requestAnimationFrame","_animate","cancelAnimationFrame","_supportsFormat","srcset","_matchesMedia","media","filename","ext","_getExtension","createElement","width","height","toDataURL","exec","query","mq","matchMedia","matches","stepWidth","stepHeight","stepRatio","parentWidth","clientWidth","parentHeight","clientHeight","parentRatio","objectFit","canvasHeight","canvasWidth","Image","onload","src","_selectPicture","_setDimensions","_drawPicture","targetColumn","targetRow","posX","posY","clearRect","drawImage","round","appendChild","getContext"],"mappings":"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"}